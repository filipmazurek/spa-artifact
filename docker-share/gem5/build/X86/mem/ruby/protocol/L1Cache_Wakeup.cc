/**
 * DO NOT EDIT THIS FILE!
 * File automatically generated by
 *   /shared/gem5/src/mem/slicc/symbols/StateMachine.py:1499
 */

// L1Cache: AMD Hammer-like protocol

#include <sys/types.h>
#include <unistd.h>

#include <cassert>
#include <typeinfo>

#include "base/logging.hh"

#include "debug/RubyGenerated.hh"
#include "debug/RubySlicc.hh"
#include "mem/ruby/protocol/L1Cache_Controller.hh"
#include "mem/ruby/protocol/L1Cache_Event.hh"
#include "mem/ruby/protocol/L1Cache_State.hh"

#include "mem/ruby/protocol/Types.hh"
#include "mem/ruby/system/RubySystem.hh"

#include "mem/ruby/slicc_interface/RubySlicc_includes.hh"
namespace gem5
{

namespace ruby
{

void
L1Cache_Controller::wakeup()
{
    if (getMemReqQueue() && getMemReqQueue()->isReady(clockEdge())) {
        serviceMemoryQueue();
    }

    int counter = 0;
    while (true) {
        unsigned char rejected[4];
        memset(rejected, 0, sizeof(unsigned char)*4);
        // Some cases will put us into an infinite loop without this limit
        assert(counter <= m_transitions_per_cycle);
        if (counter == m_transitions_per_cycle) {
            // Count how often we are fully utilized
            stats.fullyBusyCycles++;

            // Wakeup in another cycle and try again
            scheduleEvent(Cycles(1));
            break;
        }
            // L1CacheInPort triggerQueue_in
            m_cur_in_port = 3;
            try {
                            if ((((*m_triggerQueue_ptr)).isReady((clockEdge())))) {
                                {
                                    // Declare message
                                    [[maybe_unused]] const TriggerMsg* in_msg_ptr;
                                    in_msg_ptr = dynamic_cast<const TriggerMsg *>(((*m_triggerQueue_ptr)).peek());
                                    if (in_msg_ptr == NULL) {
                                        // If the cast fails, this is the wrong inport (wrong message type).
                                        // Throw an exception, and the caller will decide to either try a
                                        // different inport or punt.
                                        throw RejectException();
                                    }
                                L1Cache_Entry* cache_entry
                                 = (getCacheEntry(((*in_msg_ptr)).m_addr));
                                L1Cache_TBE* tbe
                                 = (((*m_TBEs_ptr)).lookup(((*in_msg_ptr)).m_addr));
                                    if ((((*in_msg_ptr)).m_Type == TriggerType_L2_to_L1)) {
                                        {

                                            TransitionResult result = doTransition(L1Cache_Event_Complete_L2_to_L1, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                            if (result == TransitionResult_Valid) {
                                                counter++;
                                                continue; // Check the first port again
                                            } else if (result == TransitionResult_ResourceStall) {

                                                scheduleEvent(Cycles(1));
                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                            } else if (result == TransitionResult_ProtocolStall) {

                                                scheduleEvent(Cycles(1));
                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                            }

                                        }
                                        ;
                                    } else {
                                            if ((((*in_msg_ptr)).m_Type == TriggerType_ALL_ACKS)) {
                                                {

                                                    TransitionResult result = doTransition(L1Cache_Event_All_acks, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                    if (result == TransitionResult_Valid) {
                                                        counter++;
                                                        continue; // Check the first port again
                                                    } else if (result == TransitionResult_ResourceStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    }

                                                }
                                                ;
                                            } else {
                                                    if ((((*in_msg_ptr)).m_Type == TriggerType_ALL_ACKS_NO_SHARERS)) {
                                                        {

                                                            TransitionResult result = doTransition(L1Cache_Event_All_acks_no_sharers, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                            if (result == TransitionResult_Valid) {
                                                                counter++;
                                                                continue; // Check the first port again
                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                scheduleEvent(Cycles(1));
                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                scheduleEvent(Cycles(1));
                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                            }

                                                        }
                                                        ;
                                                    } else {
                                                        panic("Runtime Error at MOESI_hammer-cache.sm:343: %s.\n", ("Unexpected message"));
                                                        ;
                                                    }
                                                }
                                            }
                                            }
                                        }
                        } catch (const RejectException & e) {
                            rejected[0]++;
                        }
            // L1CacheInPort responseToCache_in
            m_cur_in_port = 2;
            try {
                            if ((((*m_responseToCache_ptr)).isReady((clockEdge())))) {
                                {
                                    // Declare message
                                    [[maybe_unused]] const ResponseMsg* in_msg_ptr;
                                    in_msg_ptr = dynamic_cast<const ResponseMsg *>(((*m_responseToCache_ptr)).peek());
                                    if (in_msg_ptr == NULL) {
                                        // If the cast fails, this is the wrong inport (wrong message type).
                                        // Throw an exception, and the caller will decide to either try a
                                        // different inport or punt.
                                        throw RejectException();
                                    }
                                    if (m_is_blocking &&
                                        (m_block_map.count(in_msg_ptr->m_addr) == 1) &&
                                        (m_block_map[in_msg_ptr->m_addr] != &(*m_responseToCache_ptr))) {
                                            (*m_responseToCache_ptr).delayHead(clockEdge(), cyclesToTicks(Cycles(1)));
                                            continue;
                                    }
                                            
                                L1Cache_Entry* cache_entry
                                 = (getCacheEntry(((*in_msg_ptr)).m_addr));
                                L1Cache_TBE* tbe
                                 = (((*m_TBEs_ptr)).lookup(((*in_msg_ptr)).m_addr));
                                    if ((((*in_msg_ptr)).m_Type == CoherenceResponseType_ACK)) {
                                        {

                                            TransitionResult result = doTransition(L1Cache_Event_Ack, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                            if (result == TransitionResult_Valid) {
                                                counter++;
                                                continue; // Check the first port again
                                            } else if (result == TransitionResult_ResourceStall) {

                                                scheduleEvent(Cycles(1));
                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                            } else if (result == TransitionResult_ProtocolStall) {

                                                scheduleEvent(Cycles(1));
                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                            }

                                        }
                                        ;
                                    } else {
                                            if ((((*in_msg_ptr)).m_Type == CoherenceResponseType_ACK_SHARED)) {
                                                {

                                                    TransitionResult result = doTransition(L1Cache_Event_Shared_Ack, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                    if (result == TransitionResult_Valid) {
                                                        counter++;
                                                        continue; // Check the first port again
                                                    } else if (result == TransitionResult_ResourceStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    }

                                                }
                                                ;
                                            } else {
                                                    if ((((*in_msg_ptr)).m_Type == CoherenceResponseType_DATA)) {
                                                        {

                                                            TransitionResult result = doTransition(L1Cache_Event_Data, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                            if (result == TransitionResult_Valid) {
                                                                counter++;
                                                                continue; // Check the first port again
                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                scheduleEvent(Cycles(1));
                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                scheduleEvent(Cycles(1));
                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                            }

                                                        }
                                                        ;
                                                    } else {
                                                            if ((((*in_msg_ptr)).m_Type == CoherenceResponseType_DATA_SHARED)) {
                                                                {

                                                                    TransitionResult result = doTransition(L1Cache_Event_Shared_Data, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                    if (result == TransitionResult_Valid) {
                                                                        counter++;
                                                                        continue; // Check the first port again
                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                        scheduleEvent(Cycles(1));
                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                        scheduleEvent(Cycles(1));
                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                    }

                                                                }
                                                                ;
                                                            } else {
                                                                    if ((((*in_msg_ptr)).m_Type == CoherenceResponseType_DATA_EXCLUSIVE)) {
                                                                        {

                                                                            TransitionResult result = doTransition(L1Cache_Event_Exclusive_Data, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                            if (result == TransitionResult_Valid) {
                                                                                counter++;
                                                                                continue; // Check the first port again
                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            }

                                                                        }
                                                                        ;
                                                                    } else {
                                                                        panic("Runtime Error at MOESI_hammer-cache.sm:370: %s.\n", ("Unexpected message"));
                                                                        ;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                    }
                                                }
                        } catch (const RejectException & e) {
                            rejected[1]++;
                        }
            // L1CacheInPort forwardToCache_in
            m_cur_in_port = 1;
            try {
                            if ((((*m_forwardToCache_ptr)).isReady((clockEdge())))) {
                                {
                                    // Declare message
                                    [[maybe_unused]] const RequestMsg* in_msg_ptr;
                                    in_msg_ptr = dynamic_cast<const RequestMsg *>(((*m_forwardToCache_ptr)).peek());
                                    if (in_msg_ptr == NULL) {
                                        // If the cast fails, this is the wrong inport (wrong message type).
                                        // Throw an exception, and the caller will decide to either try a
                                        // different inport or punt.
                                        throw RejectException();
                                    }
                                    if (m_is_blocking &&
                                        (m_block_map.count(in_msg_ptr->m_addr) == 1) &&
                                        (m_block_map[in_msg_ptr->m_addr] != &(*m_forwardToCache_ptr))) {
                                            (*m_forwardToCache_ptr).delayHead(clockEdge(), cyclesToTicks(Cycles(1)));
                                            continue;
                                    }
                                            
                                L1Cache_Entry* cache_entry
                                 = (getCacheEntry(((*in_msg_ptr)).m_addr));
                                L1Cache_TBE* tbe
                                 = (((*m_TBEs_ptr)).lookup(((*in_msg_ptr)).m_addr));
                                    if (((((*in_msg_ptr)).m_Type == CoherenceRequestType_GETX) || (((*in_msg_ptr)).m_Type == CoherenceRequestType_GETF))) {
                                        {

                                            TransitionResult result = doTransition(L1Cache_Event_Other_GETX, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                            if (result == TransitionResult_Valid) {
                                                counter++;
                                                continue; // Check the first port again
                                            } else if (result == TransitionResult_ResourceStall) {

                                                scheduleEvent(Cycles(1));
                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                            } else if (result == TransitionResult_ProtocolStall) {

                                                scheduleEvent(Cycles(1));
                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                            }

                                        }
                                        ;
                                    } else {
                                            if ((((*in_msg_ptr)).m_Type == CoherenceRequestType_MERGED_GETS)) {
                                                {

                                                    TransitionResult result = doTransition(L1Cache_Event_Merged_GETS, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                    if (result == TransitionResult_Valid) {
                                                        counter++;
                                                        continue; // Check the first port again
                                                    } else if (result == TransitionResult_ResourceStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    }

                                                }
                                                ;
                                            } else {
                                                    if ((((*in_msg_ptr)).m_Type == CoherenceRequestType_GETS)) {
                                                            if (((machineCount(MachineType_L1Cache)) > (1))) {
                                                                    if ((cache_entry != NULL)) {
                                                                            if (((IsAtomicAccessed(cache_entry)) && m_no_mig_atomic)) {
                                                                                {

                                                                                    TransitionResult result = doTransition(L1Cache_Event_Other_GETS_No_Mig, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                    if (result == TransitionResult_Valid) {
                                                                                        counter++;
                                                                                        continue; // Check the first port again
                                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                                        scheduleEvent(Cycles(1));
                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                                        scheduleEvent(Cycles(1));
                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                    }

                                                                                }
                                                                                ;
                                                                            } else {
                                                                                {

                                                                                    TransitionResult result = doTransition(L1Cache_Event_Other_GETS, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                    if (result == TransitionResult_Valid) {
                                                                                        counter++;
                                                                                        continue; // Check the first port again
                                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                                        scheduleEvent(Cycles(1));
                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                                        scheduleEvent(Cycles(1));
                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                    }

                                                                                }
                                                                                ;
                                                                            }
                                                                        } else {
                                                                            {

                                                                                TransitionResult result = doTransition(L1Cache_Event_Other_GETS, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                if (result == TransitionResult_Valid) {
                                                                                    counter++;
                                                                                    continue; // Check the first port again
                                                                                } else if (result == TransitionResult_ResourceStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                } else if (result == TransitionResult_ProtocolStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                }

                                                                            }
                                                                            ;
                                                                        }
                                                                    } else {
                                                                        {

                                                                            TransitionResult result = doTransition(L1Cache_Event_NC_DMA_GETS, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                            if (result == TransitionResult_Valid) {
                                                                                counter++;
                                                                                continue; // Check the first port again
                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            }

                                                                        }
                                                                        ;
                                                                    }
                                                                } else {
                                                                        if ((((*in_msg_ptr)).m_Type == CoherenceRequestType_INV)) {
                                                                            {

                                                                                TransitionResult result = doTransition(L1Cache_Event_Invalidate, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                if (result == TransitionResult_Valid) {
                                                                                    counter++;
                                                                                    continue; // Check the first port again
                                                                                } else if (result == TransitionResult_ResourceStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                } else if (result == TransitionResult_ProtocolStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                }

                                                                            }
                                                                            ;
                                                                        } else {
                                                                                if ((((*in_msg_ptr)).m_Type == CoherenceRequestType_WB_ACK)) {
                                                                                    {

                                                                                        TransitionResult result = doTransition(L1Cache_Event_Writeback_Ack, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                        if (result == TransitionResult_Valid) {
                                                                                            counter++;
                                                                                            continue; // Check the first port again
                                                                                        } else if (result == TransitionResult_ResourceStall) {

                                                                                            scheduleEvent(Cycles(1));
                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                        } else if (result == TransitionResult_ProtocolStall) {

                                                                                            scheduleEvent(Cycles(1));
                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                        }

                                                                                    }
                                                                                    ;
                                                                                } else {
                                                                                        if ((((*in_msg_ptr)).m_Type == CoherenceRequestType_WB_NACK)) {
                                                                                            {

                                                                                                TransitionResult result = doTransition(L1Cache_Event_Writeback_Nack, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                                if (result == TransitionResult_Valid) {
                                                                                                    counter++;
                                                                                                    continue; // Check the first port again
                                                                                                } else if (result == TransitionResult_ResourceStall) {

                                                                                                    scheduleEvent(Cycles(1));
                                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                } else if (result == TransitionResult_ProtocolStall) {

                                                                                                    scheduleEvent(Cycles(1));
                                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                }

                                                                                            }
                                                                                            ;
                                                                                        } else {
                                                                                                if ((((*in_msg_ptr)).m_Type == CoherenceRequestType_BLOCK_ACK)) {
                                                                                                    {

                                                                                                        TransitionResult result = doTransition(L1Cache_Event_Block_Ack, cache_entry, tbe, ((*in_msg_ptr)).m_addr);

                                                                                                        if (result == TransitionResult_Valid) {
                                                                                                            counter++;
                                                                                                            continue; // Check the first port again
                                                                                                        } else if (result == TransitionResult_ResourceStall) {

                                                                                                            scheduleEvent(Cycles(1));
                                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                        } else if (result == TransitionResult_ProtocolStall) {

                                                                                                            scheduleEvent(Cycles(1));
                                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                        }

                                                                                                    }
                                                                                                    ;
                                                                                                } else {
                                                                                                    panic("Runtime Error at MOESI_hammer-cache.sm:412: %s.\n", ("Unexpected message"));
                                                                                                    ;
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        }
                                                                    }
                        } catch (const RejectException & e) {
                            rejected[2]++;
                        }
            // L1CacheInPort mandatoryQueue_in
            m_cur_in_port = 0;
            try {
                            if ((((*m_mandatoryQueue_ptr)).isReady((clockEdge())))) {
                                {
                                    // Declare message
                                    [[maybe_unused]] const RubyRequest* in_msg_ptr;
                                    in_msg_ptr = dynamic_cast<const RubyRequest *>(((*m_mandatoryQueue_ptr)).peek());
                                    if (in_msg_ptr == NULL) {
                                        // If the cast fails, this is the wrong inport (wrong message type).
                                        // Throw an exception, and the caller will decide to either try a
                                        // different inport or punt.
                                        throw RejectException();
                                    }
                                    if (m_is_blocking &&
                                        (m_block_map.count(in_msg_ptr->m_LineAddress) == 1) &&
                                        (m_block_map[in_msg_ptr->m_LineAddress] != &(*m_mandatoryQueue_ptr))) {
                                            (*m_mandatoryQueue_ptr).delayHead(clockEdge(), cyclesToTicks(Cycles(1)));
                                            continue;
                                    }
                                            
                                L1Cache_TBE* tbe
                                 = (((*m_TBEs_ptr)).lookup(((*in_msg_ptr)).m_LineAddress));
                                    if ((((*in_msg_ptr)).m_Type == RubyRequestType_IFETCH)) {
                                        L1Cache_Entry* L1Icache_entry
                                         = (getL1ICacheEntry(((*in_msg_ptr)).m_LineAddress));
                                            if ((L1Icache_entry != NULL)) {
                                                {

                                                    TransitionResult result = doTransition((mandatory_request_type_to_event(((*in_msg_ptr)).m_Type)), L1Icache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                    if (result == TransitionResult_Valid) {
                                                        counter++;
                                                        continue; // Check the first port again
                                                    } else if (result == TransitionResult_ResourceStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                        scheduleEvent(Cycles(1));
                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                    }

                                                }
                                                ;
                                            } else {
                                                L1Cache_Entry* L1Dcache_entry
                                                 = (getL1DCacheEntry(((*in_msg_ptr)).m_LineAddress));
                                                    if ((L1Dcache_entry != NULL)) {
                                                            if ((((*m_L2cache_ptr)).cacheAvail(((*in_msg_ptr)).m_LineAddress))) {
                                                                {

                                                                    TransitionResult result = doTransition(L1Cache_Event_L1_to_L2, L1Dcache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                    if (result == TransitionResult_Valid) {
                                                                        counter++;
                                                                        continue; // Check the first port again
                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                        scheduleEvent(Cycles(1));
                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                        scheduleEvent(Cycles(1));
                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                    }

                                                                }
                                                                ;
                                                            } else {
                                                                Addr l2_victim_addr
                                                                 = (((*m_L2cache_ptr)).cacheProbe(((*in_msg_ptr)).m_LineAddress));
                                                                {

                                                                    TransitionResult result = doTransition(L1Cache_Event_L2_Replacement, (getL2CacheEntry(l2_victim_addr)), (((*m_TBEs_ptr)).lookup(l2_victim_addr)), l2_victim_addr);

                                                                    if (result == TransitionResult_Valid) {
                                                                        counter++;
                                                                        continue; // Check the first port again
                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                        scheduleEvent(Cycles(1));
                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                        scheduleEvent(Cycles(1));
                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                    }

                                                                }
                                                                ;
                                                            }
                                                        }
                                                            if ((((*m_L1Icache_ptr)).cacheAvail(((*in_msg_ptr)).m_LineAddress))) {
                                                                L1Cache_Entry* L2cache_entry
                                                                 = (getL2CacheEntry(((*in_msg_ptr)).m_LineAddress));
                                                                    if ((L2cache_entry != NULL)) {
                                                                        {

                                                                            TransitionResult result = doTransition(L1Cache_Event_Trigger_L2_to_L1I, L2cache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                            if (result == TransitionResult_Valid) {
                                                                                counter++;
                                                                                continue; // Check the first port again
                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            }

                                                                        }
                                                                        ;
                                                                    } else {
                                                                        {

                                                                            TransitionResult result = doTransition((mandatory_request_type_to_event(((*in_msg_ptr)).m_Type)), L1Icache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                            if (result == TransitionResult_Valid) {
                                                                                counter++;
                                                                                continue; // Check the first port again
                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            }

                                                                        }
                                                                        ;
                                                                    }
                                                                } else {
                                                                    Addr l1i_victim_addr
                                                                     = (((*m_L1Icache_ptr)).cacheProbe(((*in_msg_ptr)).m_LineAddress));
                                                                        if (m_is_blocking &&
                                                                            (m_block_map.count(l1i_victim_addr) == 1) &&
                                                                            (m_block_map[l1i_victim_addr] == &(*m_mandatoryQueue_ptr))) {
                                                                                (*m_mandatoryQueue_ptr).delayHead(clockEdge(), cyclesToTicks(Cycles(1)));
                                                                                continue;
                                                                            }
                                                                            
                                                                        if ((((*m_L2cache_ptr)).cacheAvail(l1i_victim_addr))) {
                                                                            {

                                                                                TransitionResult result = doTransition(L1Cache_Event_L1_to_L2, (getL1ICacheEntry(l1i_victim_addr)), (((*m_TBEs_ptr)).lookup(l1i_victim_addr)), l1i_victim_addr);

                                                                                if (result == TransitionResult_Valid) {
                                                                                    counter++;
                                                                                    continue; // Check the first port again
                                                                                } else if (result == TransitionResult_ResourceStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                } else if (result == TransitionResult_ProtocolStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                }

                                                                            }
                                                                            ;
                                                                        } else {
                                                                            Addr l2_victim_addr
                                                                             = (((*m_L2cache_ptr)).cacheProbe(l1i_victim_addr));
                                                                            {

                                                                                TransitionResult result = doTransition(L1Cache_Event_L2_Replacement, (getL2CacheEntry(l2_victim_addr)), (((*m_TBEs_ptr)).lookup(l2_victim_addr)), l2_victim_addr);

                                                                                if (result == TransitionResult_Valid) {
                                                                                    counter++;
                                                                                    continue; // Check the first port again
                                                                                } else if (result == TransitionResult_ResourceStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                } else if (result == TransitionResult_ProtocolStall) {

                                                                                    scheduleEvent(Cycles(1));
                                                                                    // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                }

                                                                            }
                                                                            ;
                                                                        }
                                                                    }
                                                                }
                                                            } else {
                                                                L1Cache_Entry* L1Dcache_entry
                                                                 = (getL1DCacheEntry(((*in_msg_ptr)).m_LineAddress));
                                                                    if ((L1Dcache_entry != NULL)) {
                                                                        {

                                                                            TransitionResult result = doTransition((mandatory_request_type_to_event(((*in_msg_ptr)).m_Type)), L1Dcache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                            if (result == TransitionResult_Valid) {
                                                                                counter++;
                                                                                continue; // Check the first port again
                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                scheduleEvent(Cycles(1));
                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                            }

                                                                        }
                                                                        ;
                                                                    } else {
                                                                        L1Cache_Entry* L1Icache_entry
                                                                         = (getL1ICacheEntry(((*in_msg_ptr)).m_LineAddress));
                                                                            if ((L1Icache_entry != NULL)) {
                                                                                    if ((((*m_L2cache_ptr)).cacheAvail(((*in_msg_ptr)).m_LineAddress))) {
                                                                                        {

                                                                                            TransitionResult result = doTransition(L1Cache_Event_L1_to_L2, L1Icache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                                            if (result == TransitionResult_Valid) {
                                                                                                counter++;
                                                                                                continue; // Check the first port again
                                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                                scheduleEvent(Cycles(1));
                                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                                scheduleEvent(Cycles(1));
                                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                            }

                                                                                        }
                                                                                        ;
                                                                                    } else {
                                                                                        Addr l2_victim_addr
                                                                                         = (((*m_L2cache_ptr)).cacheProbe(((*in_msg_ptr)).m_LineAddress));
                                                                                        {

                                                                                            TransitionResult result = doTransition(L1Cache_Event_L2_Replacement, (getL2CacheEntry(l2_victim_addr)), (((*m_TBEs_ptr)).lookup(l2_victim_addr)), l2_victim_addr);

                                                                                            if (result == TransitionResult_Valid) {
                                                                                                counter++;
                                                                                                continue; // Check the first port again
                                                                                            } else if (result == TransitionResult_ResourceStall) {

                                                                                                scheduleEvent(Cycles(1));
                                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                            } else if (result == TransitionResult_ProtocolStall) {

                                                                                                scheduleEvent(Cycles(1));
                                                                                                // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                            }

                                                                                        }
                                                                                        ;
                                                                                    }
                                                                                }
                                                                                    if ((((*m_L1Dcache_ptr)).cacheAvail(((*in_msg_ptr)).m_LineAddress))) {
                                                                                        L1Cache_Entry* L2cache_entry
                                                                                         = (getL2CacheEntry(((*in_msg_ptr)).m_LineAddress));
                                                                                            if ((L2cache_entry != NULL)) {
                                                                                                {

                                                                                                    TransitionResult result = doTransition(L1Cache_Event_Trigger_L2_to_L1D, L2cache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                                                    if (result == TransitionResult_Valid) {
                                                                                                        counter++;
                                                                                                        continue; // Check the first port again
                                                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                                                        scheduleEvent(Cycles(1));
                                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                                                        scheduleEvent(Cycles(1));
                                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                    }

                                                                                                }
                                                                                                ;
                                                                                            } else {
                                                                                                {

                                                                                                    TransitionResult result = doTransition((mandatory_request_type_to_event(((*in_msg_ptr)).m_Type)), L1Dcache_entry, tbe, ((*in_msg_ptr)).m_LineAddress);

                                                                                                    if (result == TransitionResult_Valid) {
                                                                                                        counter++;
                                                                                                        continue; // Check the first port again
                                                                                                    } else if (result == TransitionResult_ResourceStall) {

                                                                                                        scheduleEvent(Cycles(1));
                                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                    } else if (result == TransitionResult_ProtocolStall) {

                                                                                                        scheduleEvent(Cycles(1));
                                                                                                        // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                    }

                                                                                                }
                                                                                                ;
                                                                                            }
                                                                                        } else {
                                                                                            Addr l1d_victim_addr
                                                                                             = (((*m_L1Dcache_ptr)).cacheProbe(((*in_msg_ptr)).m_LineAddress));
                                                                                                if (m_is_blocking &&
                                                                                                    (m_block_map.count(l1d_victim_addr) == 1) &&
                                                                                                    (m_block_map[l1d_victim_addr] == &(*m_mandatoryQueue_ptr))) {
                                                                                                        (*m_mandatoryQueue_ptr).delayHead(clockEdge(), cyclesToTicks(Cycles(1)));
                                                                                                        continue;
                                                                                                    }
                                                                                                    
                                                                                                if ((((*m_L2cache_ptr)).cacheAvail(l1d_victim_addr))) {
                                                                                                    {

                                                                                                        TransitionResult result = doTransition(L1Cache_Event_L1_to_L2, (getL1DCacheEntry(l1d_victim_addr)), (((*m_TBEs_ptr)).lookup(l1d_victim_addr)), l1d_victim_addr);

                                                                                                        if (result == TransitionResult_Valid) {
                                                                                                            counter++;
                                                                                                            continue; // Check the first port again
                                                                                                        } else if (result == TransitionResult_ResourceStall) {

                                                                                                            scheduleEvent(Cycles(1));
                                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                        } else if (result == TransitionResult_ProtocolStall) {

                                                                                                            scheduleEvent(Cycles(1));
                                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                        }

                                                                                                    }
                                                                                                    ;
                                                                                                } else {
                                                                                                    Addr l2_victim_addr
                                                                                                     = (((*m_L2cache_ptr)).cacheProbe(l1d_victim_addr));
                                                                                                    {

                                                                                                        TransitionResult result = doTransition(L1Cache_Event_L2_Replacement, (getL2CacheEntry(l2_victim_addr)), (((*m_TBEs_ptr)).lookup(l2_victim_addr)), l2_victim_addr);

                                                                                                        if (result == TransitionResult_Valid) {
                                                                                                            counter++;
                                                                                                            continue; // Check the first port again
                                                                                                        } else if (result == TransitionResult_ResourceStall) {

                                                                                                            scheduleEvent(Cycles(1));
                                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                        } else if (result == TransitionResult_ProtocolStall) {

                                                                                                            scheduleEvent(Cycles(1));
                                                                                                            // Cannot do anything with this transition, go check next doable transition (mostly likely of next port)

                                                                                                        }

                                                                                                    }
                                                                                                    ;
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                    }
                                                                                }
                        } catch (const RejectException & e) {
                            rejected[3]++;
                        }
        // If we got this far, we have nothing left todo or something went
        // wrong
        break;
    }
}

} // namespace ruby
} // namespace gem5
